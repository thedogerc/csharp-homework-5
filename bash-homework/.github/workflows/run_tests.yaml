name: Autograding
on: [push, pull_request]

jobs:
  grade-homework:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Test solutions
        id: test-solutions
        run: |
          # Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ğ¿Ğ¾Ğ´ÑÑ‡ĞµÑ‚ Ğ±ĞµĞ· ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸ÑĞ°
          passed=0
          
          # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ĞºĞ°Ğ¶Ğ´ÑƒÑ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ
          for task in task1 task2 task3 task4 task5 task6 task7 task8; do
            if [ -d "$task" ] && [ -f "$task/solution.sh" ] && [ -f "$task/test.sh" ]; then
              cd "$task"
              chmod +x test.sh solution.sh
              if ./test.sh; then
                echo "âœ… $task: PASSED"
                passed=$((passed + 1))
              else
                echo "âŒ $task: FAILED"
              fi
              cd ..
            else
              echo "âš ï¸  $task: SKIPPED (files missing)"
            fi
          done
          
          echo "Total passed: $passed/8"
          echo "passed=$passed" >> $GITHUB_OUTPUT
      
      - name: Evaluate result
        run: |
          passed=${{ steps.test-solutions.outputs.passed }}
          echo "Final score: $passed/8"
          
          if [ $passed -ge 6 ]; then
            echo "ğŸ‰ HOMEWORK PASSED"
          else
            echo "âŒ HOMEWORK FAILED - Need at least 6 tasks"
            exit 1
          fi
